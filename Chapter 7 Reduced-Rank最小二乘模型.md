第七章

降秩最小二乘模型

考虑一个线性模型

b=ax+η，a∈rm×n，

式中，η为随机噪声，给出了a和b。如果选择通过最小化残差b-a x的欧几里得范数来确定x，那么就有一个线性最小二乘问题。

（7.1）

在某些情况下，实际的解决方案x本身并不是感兴趣的主要对象，而是一个辅助的中间变量。这是一种情况，例如，在某些分类方法中，当剩余量的范数是有趣的数量时；见第10章。

最小二乘预测是另一个领域，其中的解决方案X是一个中间量，本身并不有趣（除了它应该是稳健和可靠的数字意义）。A列由解释变量的观察结果组成，用于解释因变量B的变化。在这种情况下，必须用近似解_x来解释B的变化，即相对残差应该是购物中心。给定_x和解释变量观察的新行向量，可以预测因变量的对应值：

B预测（7.2）

在这种情况下，通常不需要，甚至不希望找到实际将（7.1）中的残余量最小化的解决方案。例如，在预测中，通常有几个解释变量（几乎）是线性相关的。因此，矩阵A往往是非常病态的，最小二乘解受测量误差和浮点舍入误差的影响很大。

七十五

例7.1。matlab脚本

A=[1 0 1 1 1

1 1；

B=[A A*[1；0.5]+1e-7*randn（3,1）]；B=B*[1；1；1]+1e-4*randn（3,1）；X=B\b

创建矩阵B，其第三列几乎是其他两列的线性组合。该矩阵是非常病态的：条件数为κ2（b）≈5.969·107。脚本给出了最小二乘法的解

X=-805.95

-402.47美元

八百零七点九五

这个近似解很好地解释了因变量的变化，因为残差很小：

resn=标准（b*x-b）/标准（b）=1.9725e-14

然而，由于解的分量很大，在（7.2）的评估中会有相当大的抵消（见第1.5节），这会导致数值误差。此外，在应用程序中，可能很难解释这种解决方案。

由于矩阵的数值秩为2，最小二乘解与用于构造右手边的向量存在较大偏差。（奇异值为3.1705、0.6691和8.4425·10−8。）鉴于此，接受近似解是合理的。

xt=0.7776

零点八八九一

一点二二二二

使用截断的SVD获得

​                                                  

（参见第7.1节）。该候选解的剩余范数为1.2·10−5，与右侧扰动的数量级相同。由于（7.2）的评估中的取消要小得多或完全消除（取决于新的向量），这样的解向量可能更适合预测。

为了减少问题的不适条件，从而降低解对数据扰动的敏感度，有时会在解X所在的RN中引入一个近似的低维正交基。让基础

7.1.截断SVD：主成分回归

​             

向量是，对于k的某个（小）值，然后根据近似基确定解的坐标，我们在最小二乘问题中使ansatz x=zky并求解

（7.3）

这是一个对应于降秩模型的最小二乘问题。在下面的两个部分中，我们描述了确定这种基向量矩阵的两种方法。第一种方法是基于数据矩阵A的SVD，第二种方法是Krylov子空间方法，其中右侧影响基的选择。

7.1截断SVD：主成分回归

假设数据矩阵具有SVD

，

其中r是a的秩（注意，我们允许m≥n或m≤n）。最小二乘问题（7.1）的最小范数解（见第6.7节）是

（7.4）

当数据矩阵A的SVD“有序变化”从主方向开始时，我们看到和（7.4）中的项也是这样组织的：第一项是沿着数据矩阵主方向的解分量，第二项是沿着主方向的分量。G第二个最主要的方向，等等。

因此，如果我们更喜欢使用SVD诱导的次序，那么我们应该选择（7.3）中的矩阵zk等于a的第一个k右奇异向量（我们假设k≤r）：

.

利用这个事实

，

式中，我们得到

.

我们看到最小二乘问题min有解。

，

相当于

   

作为（7.1）的近似解。这通常被称为截断的SVD解决方案。

通常人们希望找到k的低值，这样剩余值的减少就足够大了。程序可以被表述为一种算法，有时也被称为主成分回归。

### 主成分回归（截断SVD）

\1.    求k的最小值，这样。

\2.    放

.

参数tol是一个预定义的公差。

​             

例7.2。我们使用示例1.1中的矩阵。让



| A=1101000 | 零   零   一   零   一   零   一 | 一   零   零   一   一   一   一 | 零   零   零   一   零   一   零 | 0000010_______ |
| --------- | -------------------------------- | -------------------------------- | -------------------------------- | -------------- |
|           |                                  |                                  |                                  |                |

0 0 0 1 0_



0 0 0 0 1 0 0 0 0 1

7.1.截断SVD：主成分回归

​                                                             



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     













图7.1.作为截断索引k函数的查询向量q1（实线）和q2（虚线）的残差的相对范数。

回想一下，每一列对应一个文档（这里是一个句子）。我们想知道两个查询向量q1和q2如何用解的奇异值展开（7.4）的前几个项表示，即我们将解决最小二乘问题。

，

对于不同的k值，这两个向量是

，

分别对应单词rank、page、web和english、fifa。在图7.1中，我们绘制了作为k函数的两个向量的残差的相对范数。从示例1.1中，我们发现文档的主要内容与使用google矩阵对网页的排名有关，这反映在主要的奇异向量中。由于q1“包含google术语”，它可以很好地用前几个奇异向量表示。另一方面，第二季度的术语只与“足球文件”有关，因此，作为k的函数，预计第一季度的剩余衰减速度比第二季度快。

q1和q2的前五个左奇异向量的坐标是

| u'*[q1 q2]=1.2132 | 零点一五七四 |
| ----------------- | ------------ |
| -0.5474个         | 零点五二一五 |
| 零点七六九八      | 零点七六九八 |
| -0.1817年         | 零点七八三九 |
| 零点三九八一      | -0.3352个    |

向量q1在第一个左奇异向量u1中有一个实质性的分量，因此对于k=1，残差会大大减少。由于q2在u1方面的分量很小，所以在第一步中，残差只会略有减少。

如果我们想将这个例子中的相对残差减少到0.7以下，那么我们应该选择k=2作为q1，k=4作为q2。

7.2 Krylov子空间法

当我们将截断SVD（主成分回归）用于降秩模型时，右侧完全不影响基向量Zi的选择。在实施例7.2中，这一点的影响是明显的，其中向量q2的剩余衰减率比q1慢得多。

在许多情况下，我们希望有一个剩余的快速衰减，作为任何右手边的基向量数的函数。因此，有必要让右侧影响基向量的选择。这是在数值线性代数领域中一种称为Lanczos–Golub–Kahan（LGK）双向化的算法中完成的。在化学计量学和其他领域，一种密切相关的方法被称为偏最小二乘法或潜在结构投影法（PLS）。它是一种从大量krylov子空间方法中提取出来的算法，通常用于稀疏线性系统的求解；参见例如[42，第9-10章]、[80]或关于特征值-奇异值计算，参见第15.8节。

Krylov子空间方法是递归的，但是在我们的推导中，我们将从使用householder转换将矩阵简化为双对角形式开始。本节介绍主要受[15]的影响。

### 7.2.1使用户主转换的双向化

稠密矩阵c∈的SVD算法的第一步

rm×（n+1）是通过户主转换将其简化为上双联形式。


 

从左到右。我们假设m>n。结果是

，（7.5）

其中p和w是正交的，b_是上双对角的。分解本身也可用于其他目的。例如，它通常用于最小二乘问题的近似解，既有稠密问题，也有稀疏问题。

我们用一个小例子来说明户主的双向化过程，其中c∈r6×5。首先，第一列中的所有子目录元素都通过从左到右的转换归零（转换中更改的元素用表示）：

.

然后，通过从右到右的不同的户主变换w1，我们在第一行从位置3到N零元素。

，

其中，z1是户主转换。由于这种转换不会改变第一列中的元素，所以我们刚在第一列中引入的零保持不变。第一步的结果是

.

现在，我们以类似的方式继续，通过从左到右的转换，使第二列中对角线以下的所有元素归零。矩阵p2的构造使得它不会改变c1第一行中的元素，即p2具有

结构

，

式中，P∙2∈R5×5为户主转换。我们得到

.

然后，通过从右派的转变，

，

我们在不破坏新引入的零的情况下消灭第二行元素：p1tc1w2=×0×0×0 0 0=：c2。

零

00 0

0 00____

我们以类似的方式继续，最终获得

（7.6）

一般情况下，

P=p1p2·············································

是户主转型的产物，以及



β1α1_

B_=2…..N.∈R（N+1）×N+1）βα2

βαN

βN+ 1

是上双音。

由于正交矩阵的构造方式，它们有一个特殊的结构，将在本章的其余部分中使用。

提案7.3.用p i，i=1,2，…，m表示双相分解（7.6）中p的列，然后

，

其中，c1是c的第一列，z∈rn×n是正交的。

证据。第一个关系式紧接着是ptc1=β1e1。第二个原因是，所有WI都具有这种结构

，

式中，i i∈ri×i为同一矩阵，zi为正交矩阵。

通过户主转换减少双年型需要4mn2−4n3/3次失败。如果，那么首先将a简化为上三角形式，然后将r因子双向化是更有效的方法。

假设现在我们要解决的是最小二乘问题min，其中a∈rm×n，如果我们在双向化过程中选择，那么我们得到一个等价的双向最小二乘问题。利用（7.6）和7.3，我们得到

   

哪里

.

然后，定义y=ztx，我们就可以写出余数的范数，

（7.8）

如果我们使用平面旋转序列将b简化为上双对角形式（见下文），那么双对角最小二乘问题min可以在o（n）触发器中解决。

### 7.2.2 LGK标准化

现在，我们将给出前一节的bidialogization过程的另一种描述，它允许我们以递归的方式计算分解（7.7）。这是LGK的双向化。（7.7）的最后一个方程的一部分可以写出来。

，

这意味着

.

将两边的i列（i≥2）相等，我们得到

atpi=βizi−1+αizi，

可以写的

αIzi=ATPI−βIzi−1.（7.9）

同样，将第i列等同于

，

我们得到

azi=αipi+βi+1pi+1，

可以写的

βi+1pi+1=azi−αipi。（7.10）

现在，通过从命题7.3，方程（7.9）和（7.10）中编译起始方程β1p1=b，我们得出了一个递归式：

​                     



​        









\1.    β1p1=b，z0=0

\2.    对于i=1:n

   

\3.    结束

确定系数αi−1和βi，以便

​             

如果任何αi或βi等于零，递归就会中断。可以证明（参见，例如[15，第7.2节]）在最小二乘问题的解决中，这些事件在对应于定义明确的特殊情况的意义上是无害的。

递归的bidialogization过程给出了精确的算法，与住户bidialogization的结果相同，因此生成的向量（和（满足pti pj=0和）。然而，在浮点运算中，向量随着递归的进行而失去正交性；见第7.2.7节。

### 7.2.3最小二乘问题的近似解

定义矩阵，以及

.

同样，我们可以把关系az=pb和atp=zbt写成递归，现在我们可以把递归的前k步写成矩阵方程。

azk=pk+1bk+1.（7.11）

考虑最小平方问题。注意，列向量zi是Rn中的正交向量，解决方案x就在这里。假设我们想在向量z1，z2，…，zk所跨越的子空间中找到最佳近似解。这相当于求解最小二乘问题。

，

​                                                                                                                 



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     









0 1 2 3 4 5 0 1 2 3 4 5 K

图7.2.查询向量q1（左）和q2（右）作为子空间维数k的函数的残差的相对范数。截短的SVD解的残差曲线是实心的，对于双化解的残差曲线是虚线。

式中Y∈Rk。从（7.11）我们可以看出，这与解决

，

利用的正交性，我们可以重写

，

因为b=β1p1。接下来是

，（7.12）

由于采用双对角结构，我们可以求解O（N）触发器；见下文。

例7.4。使用双标准化，我们计算了与例7.2相同的最小二乘问题的近似解。残差的相对范数，

在图7.2中，对于截短的SVD解和双向化过程，绘制为k的函数。结果表明，在这两种情况下，基于双标准化的方法比截断的SVD解更快地衰减残差。因此，在这个例子中，我们让基向量zi受右手边q1和q2的影响，这导致更小维的降秩模型。如果我们想将相对残差降低到0.7以下，那么在这两种情况下，我们都可以用双标准化方法选择k=1。

具有双对角结构的最小二乘问题（7.12）可以用

一系列平面旋转。考虑减少

   

上三角形。我们现在将证明残差的范数可以很容易地计算出来。在第一步中，我们通过在（1，2）平面上的旋转使β2归零，用余弦和正弦c1和s1。结果是

，

其中已更改的矩阵元素用HAT标记，新的非零元素用+标记。在下一步中，我们用余弦和正弦旋转使β3归零。

.

k步后的最终结果是

，

哪里。如果我们定义

平面旋转的乘积为正交矩阵qk+1∈r（k+1）×k+1，我们得到了qr分解

（7.13）

和

（7.14）

使用QR分解我们可以写

，

最小二乘问题的残差范数等于γk=β1s1···sk。由此可知，当我们生成标量系数αi和βi时，残差范数可以递归计算，因此可以监测残差的衰减。

### 7.2.4矩阵近似

双标准化过程也给出了矩阵A的低阶近似值。在这里，考虑矩阵at进行推导更为方便。假设我们要使用zk列作为RN中的近似基向量。然后，我们可以根据这个基础，通过解最小二乘问题来确定at列的坐标。

（7.15）

引理7.5。给定矩阵a∈Rm×n和矩阵zk∈Rn×k与或-

对于法向列，最小二乘问题（7.15）有解决方案。

sk=pk+1bk+1。

证据。由于ZK的柱是正交的，最小二乘问题有了解。

skt=zkt，

其中（7.11）与sk=pk+1bk+1相同。

从引理我们可以看出，在≈zk（pk+1bk+1）t处有一个最小二乘近似，或者，等价地，

a≈pk+1bk+1zkt。

然而，这不是一个“适当”的秩k近似，因为pk+1∈rm×（k+1）和

bk+1∈r（k+1）×k.现在，用bk+1的qr分解（7.13），我们得到

，

其中wk定义为pk+1qk+1的前k列。现在我们有了适当的秩k近似值a：

（7.16）

a的低阶近似表示为

| *A*               ≈ |      |
| ------------------- | ---- |
|                     |      |

.

如前所述，我们可以将低阶近似解释为如下。wk列是rm子空间的基础。在此基础上，A列的J坐标在YKT的J列给出。

### 7.2.5 Krylov子空间

在lgk双标准化中，我们创建了两组基向量，即pi和zi。它还需要证明它们跨越了哪些子空间。从递归中我们看到z1是atb的倍数，p2是b和aatb的线性组合。

通过简单的归纳证明，我们可以证明

pk∈span b，aatb，（aat）2b，…，（aat）k−1b，zk∈span atb，（ata）atb，…，（ata）k−1atb

对于k=1,2，…。表示

kk（c，b）=span b，cb，c2，…，ck−1b。

这是一个叫做krylov的子空间。我们有以下结果。

提案7.6.pk的柱是kk的正交基（aat，b），zk的柱是kk的正交基（ata，atb）。

### 7.2.6偏最小二乘法

偏最小二乘（PLS）[109，111]是一种计算近似最小二乘解的递归算法，常用于化学计量学。算法存在不同的变体，其中最常见的可能是所谓的nipals公式。

​             

NIPALS PLS算法

​             

\1.    a0= a

\2.    对于i=1,2，…，k

（d）ai=ai−1−u∙iv∙it

​             

该算法与LGK的双向化算法有一些显著的区别，最重要的是一旦计算出一对新的向量（？ui，v？i），就会对数据矩阵进行放气。然而，事实证明[32，110]PLS算法在数学上等同于一个LGK双向化的变体，该变体通过选择不是p1而是α1z1=atb开始。这意味着向量（wi）ki=1在kk（ata，atb）中形成正态基，在kk（aat，aatb）中形成正态基。

### 7.2.7计算双向化

递归版本的双向化存在生成向量失去正交性的缺点。这可以通过使用Gram-Schmidt过程重新调整向量的方法来解决。另一方面，户主bidialogization生成的向量与浮点运算中预期的一样正交；参见第4.4节。因此，对于中等维的稠密矩阵A，应该使用这个变量。

对于大型稀疏矩阵或其他结构矩阵，通常需要使用递归变量。这是因为户主算法通过正交变换修改矩阵，从而破坏结构。请注意，对于这些问题，PLS算法也有同样的缺点，因为它简化了上述算法中的矩阵（步骤（d））。

开发了一个避免存储所有向量pi和zi的lgk双向化版本[75]。


 
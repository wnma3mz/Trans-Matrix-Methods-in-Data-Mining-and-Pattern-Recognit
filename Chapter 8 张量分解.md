第八章

张量分解

8.1引言

到目前为止，在这本书中我们已经考虑了线性代数，其中的主要对象是向量和矩阵。这些可以分别被认为是一维和二维数据数组。例如，在术语文档矩阵中，每个元素与一个术语和一个文档相关联。在许多应用程序中，数据通常按照两个以上的类别进行组织。相应的数学对象通常称为张量，处理张量的数学领域是多线性代数。这里，为了简单起见，我们把自己局限于张量a=（aijk）∈rl×m×n，这是一组带有三个下标的数据；这样的张量可以用符号表示为

​             





​        

​        

​        

​        

​        

​        

​        

​        

​        





​                                               





例8.1。在手写数字分类中，训练集是一组图像，手工分为10个班。每一类都是一组一类的数字，可以认为是张量；见图8.1。如果每个数字都表示为一个16×16的表示灰度的数字矩阵，那么一组n个数字就可以组织成张量A∈R16×16×N。

我们将使用[60]的术语，将张量a∈rl×m×n称为3模阵列，即阵列的不同“尺寸”称为模式。张量a∈rl×m×n的维数是l、m和n。在这个术语中，矩阵是一个双模数组。

九十一

​               

​                            

















图8.1.一个数字的图像是一个16×16的矩阵，一组数字是张量。

在本章中，我们将矩阵svd推广到3模张量，然后在第14章中，我们将描述如何将其用于人脸识别。对n模张量的进一步推广很容易，可以在[60]中找到。事实上，人脸识别应用程序需要5模式阵列。

20世纪60年代，心理测量学和化学计量学的研究人员率先在数据分析应用中使用张量；参见例如[91]。

8.2张量的基本概念

首先定义两个张量的内积：

（8.1）

相应的规范是

（8.2）

如果我们专门定义矩阵（2模张量），我们会发现这相当于矩阵frobenius范数；见第2.4节。

接下来我们用矩阵定义张量的i模乘法。张量a∈rl×m×n与矩阵u∈rl0×l的单模积，用a×1u表示，是一个l0×m×n张量，其中项由下式给出。

（8.3）

8.2基本张量概念

要进行比较，请考虑矩阵乘法

（8.4）

我们从第2.2节回忆起，矩阵乘法等于将a中的每一列乘以矩阵u。比较（8.3）和（8.4），我们发现张量矩阵乘法的相应性质为真：在1-模积中，3-模数组中的所有列向量都是乘法。用矩阵u表示d。同样，用矩阵v表示张量的2模乘法。

   

意味着张量的所有行向量都乘以v。注意，矩阵的2模乘v等于矩阵的右乘v t，

A×2V=a v t；

3模乘法是类似的。

有时把张量展开成矩阵很方便。张量A沿三种模式展开的定义（使用（半）matlab符号；对于一般定义，见[60]）如下：

展开，展开，展开。

可以看出，沿模式i展开使该模式成为矩阵a（i）的第一个模式，其他模式是循环处理的。例如，a（j）的第i行包含a的所有元素，其中的jth索引等于i。下面是另一种放置方法。

\1.    A的列向量是A（1）的列向量。

\2.    A的行向量是A（2）的列向量。

\3.    A的3模式向量是A（3）的列向量。

a的1展开相当于将张量分为片a（：，i，：）（矩阵）并将片安排在长矩阵a（1）中。

例8.2。设b∈r3×3×3为张量，在matlab中定义为

B（：，：，1）=B（：，：，2）=B（：，：，3）=

1 2 3 11 12 13 21 22 23

4 5 6 14 15 16 24 25 26

7 8 9 17 18 19 27 28 29

然后沿第三种模式展开

\>>B3=展开（B，3）

b3=1 2 3 4 5 6 7 8 9

11 12 13 14 15 16 17 18 19

21 22 23 24 25 26 27 28 29

展开操作的逆操作被写入

折叠（展开（a））=a。

要想很好地定义折叠操作，必须提供有关目标张量的信息。在我们稍微非正式的陈述中，我们抑制了这一点。

利用展开折叠运算，我们现在可以建立一个与i模张量乘法等价的矩阵乘法：

a×i u=折叠i（u展开i（a））=折叠i（ua（i））（8.5）

根据定义，i模式和j模式乘法在以下情况下立即通勤：

（a×i f）×j g=（a×j g）×i f=a×i f×j g。

两个i模乘法满足该恒等式

（a×i f）×i g=a×i（gf）。

这很容易用（8.5）证明：

（a×i f）×i g=（foldi（f（unfoldi（a）））×i g

=foldi（g（展开i（foldi（f（展开i（a）））））=foldi（gf展开i（a））=a×i（gf）。

8.3张量SVD

矩阵支持向量机可以用不同的方法推广到张量。我们提出了一个类似于近似主成分分析的推广。它通常被称为高阶SVD（hospd）[60]。

8.3.张量SVD

定理8.3（hospd）。张量a∈rl×m×n可写成

A=S×1U（1）×2U（2）×3U（3），（8.6）

其中u（1）∈rl×l，u（2）∈rm×m，u（3）∈rn×n为正交矩阵。S是与A尺寸相同的张量；它具有所有正交性的性质：S的任意两片片在标量积（8.1）的意义上是正交的：

   

为了。单模奇异值的定义如下：

   

他们被命令

（8.7）

其他模式中的奇异值及其顺序类似。

证据。我们只给出了计算正交因子和张量s的公式；有关完整的证明，请参见[60]。计算SVD，

a（i）=u（i）∑（i）（v（i））t，i=1,2,3，（8.8）

然后放

S=A×1（U（1））T×2（U（2））T×3（U（3））T。

仍然需要证明S的切片是正交的，I型奇异值是递减的。

全正交张量S通常称为核心张量。软管如图8.2所示。

| A                                                                                                                                                                                                                     = | *U*(1) | S                                                                                                                                               *U*                                                                                       (2)                                                                                                                                               *U*                                                                                       (3) |
| ------------------------------------------------------------ | ------ | ------------------------------------------------------------ |
|                                                              |        |                                                              |

图8.2.软管的可视化。

方程式（8.6）也可写

，

其解释如下：元素spqs反映了奇异向量u（1）p、u（2）q和u（3）s组合的变化。

hosvd的计算很简单，通过以下matlab代码实现，尽管效率有点低：

函数[u1，u2，u3，s，s1，s2，s3]=svd3（a）；%计算三向张量a的hospd

[U1，S1，V]=SVD（展开（A，1））；

[u2，s2，v]=svd（展开（a，2））；

[U3，S3，V]=SVD（展开（A，3））；

S=tmul（tmul（a，u1'，1），u2'，2），u3'，3）；

假设函数tmul（a，x，i）在模式i，a×i x中用矩阵x乘以张量a。

设v为与ui相同维度的正交；然后从恒等式[60]

s×i u（i）=s×i（u（i）v v t）=（s×i v t）（×i u（i）v），

可能出现软管不是唯一的。然而，这种变换破坏了i模奇异值的有序性。因此，hosvd本质上是唯一的；例外情况是沿任何模式都有相同的奇异值。（这与矩阵SVD中出现的不唯一性类型相同。）

在某些应用中，一个模式的尺寸比其他模式的尺寸的乘积大。例如，假设

a∈rl×m×n，L>mn。然后可以证明核心张量S满足

s（i，：，：）=0，i>mn，

我们可以省略核心的零部分，将（8.6）重写为一个薄的hospd，

，（8.9）

在哪里和。

8.4用hospd近似张量

矩阵可以用SVD写成秩1项的和；见（6.2）。张量的类似展开式可以用张量矩阵的定义来推导。

8.4.用hospd近似张量

乘法：张量a∈rl×m×n可以表示为矩阵乘以奇异向量的和：

，（8.10）

其中u（3）i是u（3）中的列向量。人工智能将被识别为rm×n中的矩阵和rm×n×1中的张量。膨胀（8.10）如图所示：

| A1   | +    | A2   |
| ---- | ---- | ---- |
|      |      |      |

+···我是说。

这种扩展与其他模式类似。

很容易证明ai矩阵在标量积（8.1）意义上是正交的：

   

（在这里，我们用矩阵标识了切片s（：，：，i），并使用了标识tr（ab）=tr（ba）。

现在可以看出，展开式（8.10）可以解释如下。沿张量A第三模的每一片都可以（精确地）用正交基（其中r3是a的正3模奇异值的个数：

，（8.11）

其中，zi（j）是u（3）i的第j个分量。此外，我们还有人工智能的同时正交因式分解，

ai=s（：，：，i）×1u（1）×2u（2），

由于不同j的所有j模奇异值的次序（8.7），其性质是每个s（：，：，i）的“质量”集中在左上角。

角落。

我们将在下面的示例中说明hospd。

例8.4.给出131个手写数字，其中每个数字是16×16矩阵，我们计算了16×16×131张量的hospd。在图8.3中，我们绘制了

   

图8.3.数字（第三）模式下的奇异值。

   

图8.4.顶行显示三个矩阵a1、a2和a3，底行显示核心张量s（：、：、1）、s（：、：、2）和s（：、：、3）（分量的绝对值）的三个切片。

沿第三种模式的奇异值（不同的数字）；可以看出，前20个奇异值占了相当大比例的数字变化（注意对数刻度）。事实上，

.

前三个矩阵a1、a2和a3如图8.4所示。可以看出，第一个矩阵看起来像是不同3的平均值；这是131位数字的主要“方向”，当被视为r256中的点时。接下来的两幅图像代表不同数字之间“平均值”的主要变化方向。

8.4.用hospd近似张量

在图8.4的下一行中，我们绘制了核心张量的三个部分的绝对值：s（：，：，1），s（：，：，2）和s（：，：，3）。可以看出，这些矩阵的质量集中在左上角。

如果我们截断扩展（8.10），

，

对于一些k，那么我们有一个张量的近似值（这里是在第三种模式下），用正交基表示。我们在（8.11）中看到，a的每一个3模切片a（：，：，j）可以写成正交基矩阵aj的线性组合。在手写数字分类中（参见第10章），人们可能需要根据正交基计算未知数字的坐标。由于基的正交性，这很容易做到。

例8.5。让z表示一个未知数字。为了分类的目的，我们要根据前面例子中3的基础来计算z的坐标。这是通过解决最小二乘问题来实现的。

，

其中范数是矩阵Frobenius范数。放

.

因为基与标量积是正交的，

=0用于

我们可以重写

.

为了求最小值，我们计算了关于zj的偏导数，并把它们等于零，

，

它给出了最小二乘问题的解

​                  

   

图8.5.手写体3的压缩基矩阵。

由于核心张量的质量集中在三个指数的小值上，因此可以通过hospd在所有三种模式下同时进行数据压缩。这里我们假设在模式i.let中压缩到ki列，并且s_=s（1:k1,1:k2,1:k3）。然后考虑近似值

.

我们说明如下：

​                                                                                     





​        

​        

​        

​        









​        

​        

​        

​        





​        

​        

​        

​        

​        

​        

​        

​        

​        









​        

​        

​        

​        

















例8.6.我们从示例8.4压缩了3的基矩阵aj。在图8.5中，我们说明了压缩基矩阵

.

参见图8.4中相应的全基矩阵。注意，新的基矩阵a_j不再是正交的。


 
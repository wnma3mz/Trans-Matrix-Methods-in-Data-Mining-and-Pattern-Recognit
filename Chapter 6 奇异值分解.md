第六章

奇异值分解

即使QR分解对于解决最小二乘问题非常有用，并且具有良好的稳定性，它也有一个缺点，即它对矩阵的行和列进行不同的处理：它只为列空间提供基础。奇异值分解（SVD）以对称的方式处理行和列，因此它提供了关于矩阵的更多信息。它还对矩阵中包含的信息进行“排序”，这样，不严格地说，“支配部分”就变得可见。这使得SVD在数据挖掘和许多其他领域非常有用。

6.1分解

定理6.1（SVD）。任何m×n矩阵a，m≥n，都可以分解。

，（6.1）

其中u∈rm×m和v∈rn×n是正交的，∑rn×n是对角的，

∑=diag（σ1，σ2，…，σn）、

σ1≥σ2≥··········≥σn≥0。

证据。假设m≥n不受限制：在另一种情况下，只需将定理应用于at。我们在[42]中给出了一个证明。考虑最大化问题

.

由于我们在闭集上求连续函数的上确界，因此对某些向量x求上确界。将ax=σ1y，其中=1和

五十七

（根据定义）。利用命题4.7，我们可以构造正交

矩阵

z1=（y z／2）∈rm×m，w1=（xw／2）∈rn×n。

然后

，

因为Ytax=σ1，并且=0。放

.

然后

​                                                  

但是，因此w=0必须保持不变。因此，我们朝着a的对角化迈出了一步。证明现在是通过归纳法完成的。假设

=diag（σ2，…，σn）。

然后我们有了

.

因此，通过定义

，

证明了这个定理。

u和v列称为奇异向量，对角元素σi为奇异值。

我们在这一点上强调，这不仅是一个重要的理论结果，而且还有非常有效和精确的计算SVD的算法；见第6.8节。

SVD以不同的名称出现在其他科学领域。在统计和数据分析中，奇异向量与主分量密切相关（见第6.4节），在图像处理中，SVD的名称为karhunen–

Loewe扩展。

我们用符号说明了SVD：

6.1.分解

| *A*               =               *U* | 0                                                                                                                                 0 | *V* *T* |
| ------------------------------------- | ------------------------------------------------------------ | ------- |
|                                       |                                                              |         |

m×n m×m×n

用分区u=（u1 u2），其中u1∈rm×n，我们得到了薄的svd，

A=U1∑V t，

象征性地说明，

| *A*               =               *U* | 0                                                                                       0 | *V* *T* |
| ------------------------------------- | ------------------------------------------------------------ | ------- |
|                                       |                                                              |         |

m×n m×n×n

如果我们写出矩阵方程

av=u1∑，atu1=v∑

一列接一列，我们得到等效方程

avi=σiui，atui=σivi，i=1,2，…，n.

SVD也可以写成矩阵的扩展：

（6.2）

这通常被称为外部产品形式，它是从

精简版：

   

SVD的外部产品形式如图所示：

++···我是说。

例6.2。我们计算全列秩矩阵的SVD：

A=1 1

1 2

1 3

1 4

\>>[U，S，V]=SVD（A）

| U=0.2195-0.8073                                              | 零点零二三六 | 零点五四七二 |
| ------------------------------------------------------------ | ------------ | ------------ |
| 0.3833至0.3912                                               | -0.4393个    | -0.7120个    |
| 0.5472 0.0249                                                | 零点八零七九 | -0.2176个    |
| 0.7110 0.4410   S=5.7794 0   0 0.7738   0 0   0 0   V=0.3220-0.9467   0.9467 0.3220   SVD的精简版本为>>[U，S，V]=SVD（A，0）   U=0.2195-0.8073   0.3833至0.3912   0.5472 0.0249   0.7110 0.4410   S=5.7794 0   0.7738 V=0.3220-0.9467 | -0.3921个    | 零点三八二四 |
| 0.9467 0.3220                                                |              |              |

第2.4节定义了矩阵2-范数。从定理6.1的证明我们已经知道了。这是一个非常重要的事实，值得单独提出一个建议。

6.2.基本子空间

提案6.3.矩阵的2-范数由

.

证据。以下是另一种证明。在不失去一般性的前提下，假设a∈rm×n，m≥n，并使a的svd为a=u∑v t，在正交变换下范数是不变的，因此

.

现在的结果如下，因为对角矩阵的2-范数等于最大对角元素的绝对值：

   

y=e1相等。

6.2基本子空间

SVD给出了矩阵的四个基本子空间的正交基。矩阵A的范围是线性子空间。

r（a）=y y=a x，任意x。

假设a的等级为r：

σ1≥·····································

然后，使用外部产品形式，我们有

.

矩阵A的零空间是线性子空间。

n（a）=x a x=0。

因为，我们看到任何向量都在空值中-

## 空间：

.

经过类似的论证，我们得到了下面的定理。

定理6.4（基本子空间）。

\1.    奇异向量u1，u2，…，ur是r（a）和

等级（a）=dim（r（a））=r。

\2.    奇异向量vr+1，vr+2，…，vn是n（a）和

尺寸（n（a））=n−r。

\3.    奇异向量v1，v2，…，vr是r（at）中的正交基。

\4.    奇异向量ur+1，ur+2，…，um是n（at）中的正交基。

例6.5。我们通过在前面的例子中构造第三列作为列1和列2的线性组合来创建一个缺秩矩阵：

\>>A（：，3）=A（：，1）+0.5*A（：，2）

| A=1.0000   1.0000                       | 一点五零零零 |              |
| --------------------------------------- | ------------ | ------------ |
| 1.0000 2.0000                           | 二           |              |
| 1.0000 3.0000                           | 二点五零零零 |              |
| 1.0000 4.0000   >>[U，S，V]=SVD（A，0） | 三           |              |
| U=0.2612                                | -0.7948个    | -0.5000元    |
| 零点四零三二                            | -0.3708个    | 零点八三三三 |
| 零点五四五一                            | 零点零五三三 | -0.1667个    |
| 零点六八七一                            | 零点四七七四 | -0.1667个    |
| S=7.3944                                | 零           | 零           |
| 零                                      | 零点九零七二 | 零           |
| 零                                      | 零           | 零           |
| V=0.2565                                | -0.6998      | 零点六六六七 |
| 零点七三七二                            | 零点五八七七 | 零点三三三三 |
| 零点六二五一                            | -0.4060个    | -0.6667个    |

第三奇异值等于零，矩阵是秩亏矩阵。显然，v的第三列是n（a）中的基向量：

\>>A*V（：，3）

ANS＝

1.0E-15型*

零

-0.2220个

-0.2220个

零

6.3.矩阵近似

​                                                     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     



​     

​     

​     

​     





​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     





​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     





​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     

​     













图6.1.秩10加噪声的矩阵的奇异值。

6.3矩阵近似

假设a是一个低阶矩阵加上噪声：a=a0+n，其中噪声n比a0小。通常情况下，a的奇异值的行为如图6.1所示。在这种情况下，如果噪声的大小足够小，则大的奇异值的数量通常被称为矩阵的数值等级。如果我们知道a0的正确秩，或者可以估计它，例如通过检查奇异值，那么我们可以通过用正确秩的矩阵近似a来“去除噪声”。最明显的方法就是简单地截断奇异值展开（6.2）。假设数值等级等于k，则我们近似

.

截短的SVD非常重要，不仅用于消除噪声，还用于压缩数据（见第11章），以及稳定极端病态问题的解决方案。

结果表明，截断SVD是一个近似问题的解，即人们希望用一个较低的秩来近似一个给定的矩阵。我们将在两个规范中考虑矩阵A的低阶近似。首先给出了矩阵2-范数的定理。

定理6.6.假设矩阵A∈Rm×N具有秩r>k，矩阵逼近问题

最小Z级（

有解决方案

Z=ak：=uk∑kvkt，

其中，uk=（u1，…，uk），vk=（v1，…，vk）和∑k=diag（σ1，…，σk）。最小值是

.

这一定理的证明可以在[42，第2.5.5节]中找到。接下来回顾弗罗贝尼乌斯矩阵范数的定义（2.7）

.

结果表明，这种情况下的近似结果是相同的。

定理6.7。假设矩阵A∈Rm×N具有秩r>k，frobenius范数矩阵逼近问题

最低F级（

有解决方案

，

其中，uk=（u1，…，uk），vk=（v1，…，vk）和∑k=diag（σ1，…，σk）。最小值是

，

其中p=最小值（m，n）。

为了证明这个定理，我们需要一个引理。

引理6.8。考虑具有内积的mn维向量空间Rm×n

（6.3）

和标准

.

6.3.矩阵近似

设a∈rm×n，SVD a=u∑v t，然后求矩阵

uivjt，i=1,2，…，m，j=1,2，…，n，（6.4）

是Rm×N中的正态基。

证据。使用身份）我们得到

，

这表明矩阵是正交的。因为有mn这样的矩阵，它们以rm×n构成一个基。

证明（定理6.7）。这一证据是基于[41]中的证据。根据基（6.4）写出矩阵Z∈Rm×N，

，

选择系数的位置。在这个证明中，我们用σij表示∑的元素。由于基的正态性，我们有

.

显然，我们可以选择第二项为等于零。然后，z的表达式如下：

.

因为z的秩等于这个和中的项数，我们看到约束秩（z）=k意味着在和中应该正好有k个非零项。为了最小化目标函数，我们选择

ζi i=σii，i=1,2，…，k，

这就产生了预期的结果。

矩阵的低阶近似表示为

| *A*               ≈ |      |
| ------------------- | ---- |
|                     |      |

=英国∑kvkt。

6.4主成分分析

SVD的近似性质可以用来说明SVD与主成分分析（PCA）的等价性。假设x∈rm×n是一个数据矩阵，其中每列都是一个均值为零的实值随机向量的观测值。假设矩阵居中，即每列的平均值等于零。设x的svd为x=u∑v t，右奇异向量vi称为x的主分量方向[47，p.62]。矢量

z1=xv1=σ1u1

在x列的所有标准化线性组合中，样本方差最大：

.

使用线性代数术语，求最大方差的向量，等于最大化瑞利商：

T T

=argmax.

归一化变量u1=（1/σ1）xv1称为x的归一化第一主成分。

在确定了最大样本方差的向量之后，我们通常要继续寻找与第一个样本方差正交的第二大样本方差的向量。这是通过计算缩减数据矩阵最大样本方差的向量来实现的。继续这个过程，我们可以按顺序确定所有的主要成分，也就是说，我们计算奇异向量。在程序的一般步骤中，随后的主分量被定义为最大方差的向量，受其与前一个方差正交的约束。

那些。

例6.9.PCA如图6.2所示。从相关正态分布中生成500个数据点，并收集在数据矩阵X∈R3×500中。数据点和主要组件在图的顶部图表中进行了说明。然后，我们对数据矩阵x1：=x−σ1u1v1t进行放气；对应于x1的数据点在底部图中给出。

6.5解决最小二乘问题

利用支持向量机可以解决最小二乘问题。假设我们有一个超定系统ax～b，其中矩阵a有全列秩。写

SVD

，

6.5.求解最小二乘问题

   

图6.2.顶部：R3中具有（缩放）主要组件的点群。底部：与第一个主成分的贡献相同的数据被缩减。

其中U1∈Rm×N.利用SVD和范数在正交变换下不变的事实，我们得到

，

其中，bi=uitb，y=v tx。因此

.

现在我们可以通过输入y=∑−1b1来最小化。最小二乘解由

（6.5）

记住∑是对角线，

∑1=diag，

因此，也可以编写解决方案

.

假设a具有完整的列秩，意味着所有的奇异值都是非零的：σi>0，i=1,2，…，n。我们还发现在这种情况下，解是唯一的。

定理6.10（SVD最小二乘解）。假设矩阵A∈Rm×N具有全列秩和细SVD A=U1∑V t，则最小二乘问题具有唯一解。

.

例6.11。作为一个例子，我们解决了第3.6章开头给出的最小二乘问题。矩阵和右手边是

| A=1   1                                                      | B=7.9700      |
| ------------------------------------------------------------ | ------------- |
| 1 2                                                          | 2000年10月    |
| 1 3                                                          | 2000年14月    |
| 1 4                                                          | 16.0000元     |
| 1 5   >>[U1，S，V]=SVD（A，0）   U1=0.1600-0.7579   0.2853-0.4675 0.4106-0.1772   0.5359 0.1131 0.6612 0.4035   S=7.6912 0   0.9194美元   V=0.2669-0.9637   0.9637 0.2669 | 2000年2月21日 |


 

6.6.最小二乘问题的条件数和扰动理论

​             

A中的两列向量是线性无关的，因为奇异值都是非零的。使用（6.5）解决最小二乘问题：

\>>X=V*（S \（U1'*B））

X=4.2360

三点二二六零

6.6最小二乘问题的条件数和扰动理论

用支持向量机定义了矩形矩阵的条件数。让a有秩r，即其奇异值满足

σ1≥·····································

其中p=最小值（m，n）。然后定义条件编号

.

注意，在一个正方形非奇异矩阵的情况下，这简化为定义。

（3.3）。

Wedin[106]证明了以下微扰定理。

定理6.12。假设矩阵A∈Rm×N，其中m≥n具有全列秩，设x为最小二乘问题的解。设δa

δb是这样的扰动

.

然后扰动矩阵a+δa具有满秩，解δx的扰动满足

，

其中r是剩余的r=b−ax。

这里至少要做两个重要的观察：

\1.    数字k决定最小二乘问题的条件，如果m=n，则剩余r等于零，不等式成为线性方程组的扰动结果；参见定理3.5。

\2.    在超定情况下，残差通常不等于零。那么条件取决于κ2。如果残差的范数很大，这种依赖性可能很重要。

6.7等级不足和不确定系统

假设a是秩亏，即秩（a）=r<m i n（m，n）。最小二乘问题仍然可以解决，但解决方案不再是唯一的。在这种情况下，我们编写SVD

，（6.6）

哪里

，（6.7）

并且∑1的对角线元素都是非零的。残差的范数现在可以写了。

.

放

   

利用正交变换下范数的不变性

变成

.

因此，我们可以通过选择y1=∑−1 1b1来最小化残差。事实上，

，

其中y2是任意的，解决了最小二乘问题。因此，最小二乘问题的解是不唯一的，并且，由于v2的列跨越了a的空空间，所以它在这个空空间中，不确定度在这里。我们可以写信

，

因此，我们选择y2=0得到最小范数的解。我们将推导归纳为一个定理。

### 定理6.13（最小范数解）。假设矩阵A是秩

SVD不足（6.6），（6.7）。那么最小二乘问题就没有唯一的解了。然而，问题是

，

6.7.等级不足和不确定系统

有独特的解决方案

   

矩阵

   

称为a的伪逆矩阵。它是为任意非零矩阵定义的。

尺寸。

SVD也可用于求解不确定线性系统，即未知量比方程多的系统。设a∈rm×n，m<n。A的SVD是

（6.8）

| 显然，如果且只有∑是非奇异的，则a具有整行秩。我们提出一个关于线性系统解的定理。 |         |
| ------------------------------------------------------------ | ------- |
| AX＝B                                                        | （6.9） |

对于A具有完整行排名的情况。

定理6.14（欠定线性系统的解）。设a∈rm×n与svd（6.8）具有全行秩。那么线性系统（6.9）总是有一个解，然而，这个解是不唯一的。问题

，（6.10）

| 有独特的解决方案 |          |
| ---------------- | -------- |
| x=v1∑−1utb。     | （6.11） |

证据。使用SVD（6.8），我们可以编写

.

因为∑是非奇异的，我们可以看到，对于任何右侧，（6.11）都是线性系统的解。但是，我们可以在的空空间中添加任意的解决方案组件，并且我们仍然有一个解决方案。最小范数解，

即（6.10）的解由（6.11）给出。

根据右手边的不同，秩亏情况可能有解，也可能没有解，这种情况可以很容易地用定理6.13来处理。

6.8计算SVD

svd在matlab中由语句[u，s，v]=svd（a）计算。此语句是Lapack[1]中算法的实现。（SVD的双精度高级驱动算法称为dgesvd。）在该算法中，首先通过从左到右的一系列户主变换将矩阵简化为双对角形式。然后使用QR算法的变种将双对角矩阵迭代地简化为对角形式；见第15章。

稠密（全）矩阵的支持向量密度可以用O（mn2）触发器计算。根据计算出的量，常数的顺序为5–25。

在matlab中，通过语句[u，s，v]=svds（a，k），计算大型稀疏矩阵的部分svd。此语句基于来自arpack的lanczos方法。我们在第15章中简要描述了Lanczos算法。有关更全面的治疗，请参阅[4]。

6.9完全正交分解

在矩阵秩亏的情况下，计算SVD是确定秩的最可靠的方法。但是，它的缺点是计算成本相对较高，并且更新成本较高（添加新行和/或列时）。这两个问题可能都很关键，例如在实时应用程序中。因此，已经开发出了一种近似SVD的方法，即所谓的完全正交分解法，这种方法在无噪声的情况下和在精确的算法中都可以写成

   

对于正交q和z以及三角形t∈r r×r，当a具有秩r时，显然，svd是完全正交分解的特例。

在本节中，我们假设矩阵a∈r m×n，m≥n具有精确的或数值的秩r（回顾第63页数值秩的定义）。

### 6.9.1带立柱旋转的QR

获得完全正交分解的第一步是在QR分解的计算中执行柱旋转[22]。在算法开始之前考虑矩阵：计算每列的2个范数，并将最大范数的列移到最左边的位置。这相当于用右边的置换矩阵p1乘以矩阵。在还原为三角形的第一步中，应用了户主转换，以消除第一列中的元素：

.

然后在下一步中，找到b中具有最大范数的列，对这些列进行排列，以便将具有最大范数的列移动到a中的位置2（这仅涉及

6.9.完全正交分解

当然，第2列到第n列），并减少b的第一列：

.

可见r11≥r22。

经过n个步骤后，我们计算出

.

置换矩阵的乘积本身就是置换矩阵。

提案6.15。假设a的秩为r，那么，在精确的算法中，列旋转的qr分解由下式给出：

，

并且R11的对角线元素是非零的（R11是非奇异的）。

证据。显然，过程中出现的对角线元素是不增加的：r11≥r22≥····。

假设r r+1，r+1>0。这意味着QR分解中r的秩大于r，这是一个矛盾，因为r和a必须具有相同的秩。

例6.16。下面的matlab脚本执行QR分解，其中列以构造为缺乏秩的矩阵为轴：

[u，ru]=qr（randn（3））；[v，rv]=qr（randn（3））；

d=diag（[1 0.5 0]）；a=u*d*v'；

[q，r，p]=qr（a）；%qr，柱旋转

R=-0.8540 0.4311-0.0642 0 0.4961-0.2910

0 0 0.0000

\>>R（3,3）=2.7756E-17

在许多情况下，带有旋转的QR分解提供了关于矩阵数值等级的合理准确信息。我们通过添加噪声来修改前面脚本中的矩阵：

[u，ru]=qr（randn（3））；[v，rv]=qr（randn（3））；

d=diag（[1 0.5 0]）；a=u*d*v'+1e-4*randn（3）；

[q，r，p]=qr（a）；

\>>R=0.8172-0.4698-0.1018 0-0.5758 0.1400

0 0 0.000 1

最小对角线元素的数量级与最小对角线元素的数量级相同。

奇异值：

\>>SVD（A）=1.0000

0.4999 0.000一

然而，事实证明，人们不能完全依靠这个过程来提供关于可能的等级缺陷的正确信息。我们给出了卡汉的一个例子；见[50，第8.3节]。

例6.17。设c2+s2=1。对于n足够大，三角形矩阵

tn（c）=diag（1，s，s2，…，sn−1）……___1−1c−cc·······−cc 1−1c

是非常病态的。对于n=200和c=0.2，我们有

.

因此，在IEEE双精度中，矩阵是奇异的。三角形矩阵的列都有长度1。因此，由于对角线右边每一行的元素是相等的，因此以柱为轴的QR分解不会引入任何柱交换，上三角矩阵r等于tn（c）。但是，底部对角线元素等于s199≈0.0172，因此对于此矩阵qr（具有柱枢转），没有提供任何关于病态条件的信息。
第四章

正交性

即使求解线性方程组和正态方程组的高斯消去法是一种广泛应用于许多应用中的标准算法，但在需要将最重要的信息与不重要的信息分开的情况下，这种方法仍然不够。（噪音）。“数据质量”的典型线性代数公式是对“好基向量和坏基向量”的概念进行量化；不严格地说，好基向量是那些“非常线性无关”的向量，即接近正交的向量。在同样的情况下，几乎线性相关的向量是坏基向量。在这一章中，我们将介绍一些理论和正交向量计算算法。第6章给出了一组向量“质量”的更完整的量化。

例4.1.在示例3.13中，我们看到，在最小二乘问题中选择不合适的基向量会导致病态正态方程。沿着相似的线，定义两个矩阵

，

其列如图4.1所示。可以看出，这两个矩阵的列向量在r3中跨同一平面。从图中可以清楚地看出，B的柱是正交的，它比A的柱确定平面要好得多，A的柱是非常接近的。

从多个角度来看，在向量空间中使用正交向量作为基向量是有利的。在本章中，我们将列出正交向量集和正交矩阵的一些重要性质。我们假设向量在rm中，m≥n。

三十七

​                                                                                                                                                                                                                               



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     



​     

​     

​     





​                                               





图4.1.在r3中跨越一个平面的三个矢量。

4.1正交向量和矩阵

我们首先回顾两个非零向量x和y，如果xty=0（即cosθ（x，y）=0，则称为正交向量。

提案4.2.设qj，j=1,2，…，n，为正交，即。然后它们是线性无关的。

证据。假设它们是线性相关的。那么，从命题2.2，存在一个qk，这样

.

用这个方程乘以qkt，我们得到

，

因为向量是正交的。这是一个矛盾。

使Rm中的正交向量组qj，j=1,2，…，m归一化，

.

然后它们被称为正交，在rm中它们构成正交基。

方阵

   

4.1.正交向量和矩阵

其列是正交的称为正交矩阵。正交矩阵满足我们在一系列命题中列出的一些重要性质。

提案4.3.正交矩阵q满足qtq=i。

证明。

   

由于正态性。

其列的正交性意味着正交矩阵具有满秩，求逆矩阵的难度很小。

提案4.4.正交矩阵q∈rm×m具有秩m，且由于qtq=i，其逆矩阵等于q−1=qt。

提案4.5.正交矩阵的行是正交的，即qqt=i。

证据。设x为任意向量。我们将证明qqtx=x。给定x有一个唯一确定的向量y，这样qy=x，因为q-1存在。然后

qqtx=qqtqy=qy=x。

因为x是任意的，所以qqt=i。

提案4.6.两个正交矩阵的乘积是正交的。

证据。设q和p为正交，x=pq。然后

xtx=（pq）tpq=qtppq=qtq=i。

任意Rm子空间的正交基都可以扩大到整个空间的正交基。下一个命题用矩阵表示。

提案4.7.给定一个矩阵q1∈rm×k，有正交列，存在一个矩阵q2∈rm×k（m−k），使得q=（q1q2）是一个正交矩阵。

这个命题是线性代数的标准结果。稍后我们将演示如何计算q。

正交矩阵的一个最重要的性质是保持向量的长度。

提案4.8.向量的欧氏长度在正交变换q下是不变的。

证据。.

相应的矩阵范数和弗罗贝尼乌斯范数在正交变换下是不变的。

提案4.9.设u∈rm×m与v∈rn×n为正交。那么对于任何

A∈Rm×N，

.

证据。第一个等式很容易用命题4.8证明。第二个是用弗罗贝尼乌斯范数的替代表达式（2.8）和同一性Tr（bc）=Tr（cb）证明的。

4.2初等正交矩阵

我们将使用初等正交矩阵将矩阵简化为紧致形式。例如，我们将矩阵A∈Rm×N，m≥N转换成三角形。

### 4.2.1平面旋转

2×2平面旋转矩阵

，

是正交的。向量x乘以g，以顺时针方向将向量旋转一个角度θ，其中c=cosθ。平面旋转可通过选择以下选项使向量x的第二个元素归零：

.

通过在较大的单位矩阵中嵌入二维旋转，可以操纵任意维的向量和矩阵。

4.2.初等正交矩阵

例4.10。我们可以选择C和S

__1 0 0 0__

0摄氏度0秒

g=

0 0 1 0

0−S 0 C

在matlab脚本中，我们通过平面（2，4）中的旋转使向量x∈r4中的元素4归零。执行

x=[1；2；3；4]；sq=sqrt（x（2）^2+x（4）^2）；c=x（2）/sq；s=x（4）/sq；

g=[1 0 0 0；0 c 0 s；0 0 1 0；0-s 0 c]；y=g*x给出结果

Y=1.0000

四点四七二一

三

零

使用平面旋转序列，我们现在可以将任意向量转换为单位向量的倍数。这可以通过几种方式实现。我们在下面的示例中演示一个。

例4.11.g3在平面（3given a vector，4）中，我们将最后一个元素x∈r4归零，我们将其转换为：κe1。首先，通过旋转

.

然后，通过平面（2,3）中的旋转g2，我们将位置3中的元素归零：

.

最后，第二个元素被旋转g1湮灭：

.

根据命题4.8，欧几里得长度被保留，因此我们知道。

我们总结这些转变。我们有

κe1=g1（g2（g3x））=（g1g2g3）x。

因为正交矩阵的乘积是正交的（命题4.6），所以矩阵p=g1g2g3是正交的，总的结果是px=κe1。

平面旋转非常灵活，可以有效地用于稀疏结构的问题，例如带矩阵。另一方面，对于密集矩阵，它们需要比户主转换更多的触发器；见第4.3节。

例4.12。在本节前面的matlab示例中，我们显式地将2×2嵌入到更大尺寸的矩阵中。这是浪费操作，因为计算机执行代码时没有考虑到矩阵只有两行被更改的事实。相反，执行整个矩阵乘法，在维度n矩阵的情况下需要2n3个触发器。下面两个matlab函数说明了如何执行旋转以保存操作（和存储）：

函数[c，s]=rot（x，y）；

%构造一个平面旋转，使向量[x；y]中的第二个%分量归零（x和y是标量）sq=sqrt（x^2+y^2）；c=x/sq；s=y/sq；

函数x=近似值（c，s，i，j，x）；

%在平面（i，j）中应用平面（平面）旋转

%到矩阵X

x（[i，j]，：）=[c s；-s c]*x（[i，j]，：）；

下面的脚本将向量x减少到标准基向量e1的倍数：

x=[1；2；3；4]；对于i=3:-1:1

[c，s]=rot（x（i），x（i+1））；x=近似值（c，s，i，i+1，x）；

结束

\>>X=5.4772

零

零

零

减去后，x的第一个分量等于。

4.2.初等正交矩阵

### 4.2.2户主改造

设=0为任意向量，并将

；

P是对称和正交的（通过简单的计算来验证这一点！）这种矩阵称为反射矩阵或户主变换。让x和y被赋予相同长度的向量，然后问问题，“我们能确定

一个户主转换p，使得px=y？“公式px=y可以写成

   

它的形式是βv=x-y。由于v以β因子抵消的方式进入p，我们可以选择β=1。当v=x-y时，我们得到

vtv=xtx+yty−2xty=2（xtx−xty）

因为XTX=Yty。此外，

   

所以我们有

   

如我们所愿。在矩阵计算中，我们通常希望向量中的元素为零，现在我们选择y=κe1，其中，和。这个

向量v应等于

V=x−κe1。

为了避免取消（即两个近浮点数的减法），我们选择符号（k）=-符号（x1）。现在我们已经计算了v，我们可以简化并编写

   

因此，户主向量u的长度为1。户主向量的计算可在以下matlab代码中实现：

函数u=househ（x）

%计算户主向量u，使

%（i-2 u*u’）x=k*e_1，其中

%| k等于x%的欧几里得范数，e_1是第一个单位向量n=长度（x）；%x中的分量数

kap=范数（x）；v=零（n，1）；v（1）=x（1）+符号（x（1））*kap；v（2:n）=x（2:n）；u=（1/范数（v））*v；

在大多数情况下，应避免明确形成户主矩阵P，因为它可以更紧凑地由向量U表示。应根据p x=x−（2utx）U进行p乘，其中矩阵向量乘需要4N个触发器（如果p是形式，则不是o（n2））。D明确）。矩阵乘法px完成

Px=A−2U（UTX）。（4.1）

通过户主转换的乘法在以下代码中实现：

函数y=apphouse（u，x）；

%将矩阵x乘以户主矩阵

%y=（i-2*u*u'）*x

y=x-2*u*（u'*x）；

例4.13。矢量的前三个元素由以下matlab语句序列归零：

\>>X=[1；2；3；4]；>>U=房屋H（X）；

\>>Y=应用程序库（U，X）

Y=-5.4772 0

零

零

由于平面旋转可以嵌入到单元矩阵中，为了结构化地应用转换，我们同样可以嵌入户主转换。例如，假设我们已经将矩阵中的第一列转换为单位向量，然后我们希望将主对角线下面第二列中的所有元素归零。因此，在一个5×4矩阵的例子中，我们要计算转换


 

4.3.浮点运算数

​             

| ×××。   2a（1）=p2___×000×××______×00   P××X=0   ×××。   0××0   对（1）的第二列进行如下分区： | ×   ×0   零   零 | ×   ×   ×   ×   × | ×__=：A   ×（2）   ××。   ×   × | （4.2） |
| ------------------------------------------------------------ | ---------------- | ----------------- | ------------------------------- | ------- |
|                                                              |                  |                   |                                 |         |

，

其中是一个标量。我们知道如何转换为单位向量；让p_2成为一个这样做的户主转换。然后，通过将p_2嵌入到单位矩阵中来实现转换（4.2）：

（4.3）

很明显，p2使a（1）的第一行保持不变，并计算转换（4.2）。另外，很容易看到第一列中新创建的零没有被销毁。

与平面旋转的情况类似，不应将户主变换显式嵌入更大维度的单位矩阵中。相反，应该将它应用于在转换过程中受影响的行（在从左边进行乘法的情况下）。

例4.14.（4.2）中的转换通过以下语句完成。

u=房屋h（a（2:m，2））；a（2:m，2:n）=apphouse（u，a（2:m，2:n））；

| >>A=-0.8992 | -0.6708个    | -0.7788个    | -0.9400元    |
| ----------- | ------------ | ------------ | ------------ |
| -0.0000元   | 零点三二九九 | 零点七四零零 | 零点三八九一 |
| -0.0000元   | 零           | -0.1422个    | -0.6159个    |
| -0.0000元   | -0.0000元    | 零点七五七六 | 零点一六三二 |
| -0.0000元   | -0.0000元    | 零点三零五三 | 零点四六八零 |

4.3浮点运算次数

我们将比较使用平面变换和户主变换将m×n矩阵a的第一列转换为单位向量k e1的倍数的触发器的数目。考虑第一个平面旋转。显然，计算

   

需要四个乘法和两个加法，即六个浮点运算。将这种转换应用于m×n矩阵需要6n个触发器。为了使矩阵第一列中除一个元素以外的所有元素归零，我们应用m-1旋转。因此，总故障计数为6（m−1）n≈6mn。

如果按照（4.1）中的方式通过户主转换执行相应的操作，那么只需要4mn的触发器。（请注意，乘2不是一个触发器，因为它是由编译器作为移位实现的，这比

​             

触发器；或者，可以用√2缩放向量u。）

4.4浮点正交变换

算术

正交变换在浮点运算中非常稳定。例如，可以证明[50，第367页]浮点数p_中计算得出的近似于精确p的户主转换满足

，

其中，μ是浮点系统的四舍五入单位。我们还有向后误差的结果

.

因此，浮点结果等于精确正交矩阵和数据矩阵的乘积，数据矩阵受到非常小的扰动。类似的结果适用于平面旋转。